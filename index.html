<!doctype html>
<html lang="en"><head>
    <meta charset="utf-8">
    <title>Wraith Documentation</title>
    <!-- Mobile viewport optimized -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <!-- Mobile Internet Explorer allows us to activate ClearType technology for smoothing fonts for easy reading -->
    <meta http-equiv="cleartype" content="on">

    <!-- Le styles -->
    <link href="css/bootswatch/Cosmo/bootstrap.min.css" rel="stylesheet">
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/black-tie/jquery-ui.css" rel="stylesheet">
    <link href="css/jquery.tocify.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet" type="text/css">
    <link href="css/styles.css" rel="stylesheet" type="text/css">
    <link href="css/rainbow/themes/tomorrow-night.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="css/rainbowlines/theme.css" media="screen" />
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link href="../assets/ico/favicon.ico" rel="shortcut icon">
    <link href="../assets/ico/apple-touch-icon-144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="../assets/ico/apple-touch-icon-114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114">
    <link href="../assets/ico/apple-touch-icon-72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72">
    <link href="../assets/ico/apple-touch-icon-57-precomposed.png" rel="apple-touch-icon-precomposed">
  </head>

  <body>
   <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="margin-bottom:120px;">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="index.html">Wraith</a>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">
      <li class="active"><a href="index.html">Main Documentation</a></li>
      <li class><a href="os-install.html">Requirements Installation</a></li>
    </ul>
  </div><!-- /.navbar-collapse -->
</nav>


    <div class="container-fluid" style="margin-top:50px;">
      <div class="row">
        <div class="tocify col-sm-3 col-md-3">
          <div id="toc">
          </div><!--/.well -->
        </div><!--/span-->
        <div class="col-sm-9 col-md-9">
          <div class="jumbotron">
            <h1>Wraith</h1>
            <p>A responsive screenshot comparison tool</p>
            <br>
            <p>The project is hosted on <a class="projectLinks" href="https://github.com/BBC-News/wraith" target="_blank">Github</a> and is available for use under the <a class="projectLinks" href="https://github.com/BBC-News/wraith/blob/master/LICENSE" target="_blank">Apache 2.0 open source license</a>.  You can report bugs and discuss features on the <a href="https://github.com/BBC-News/wraith/issues?state=open" target="_blank">GitHub issues page</a>, or send tweets to <a href="https://twitter.com/ResponsiveNews" target="_blank">@ResponsiveNews</a>.
            </p>
            <p><a class="btn btn-primary btn-lg" href="https://github.com/BBC-News/wraith" target="_blank">Fork on Github »</a></p>
          </div>
          <h2>Requirements</h2>
          <!-- <br> -->
          <p class="well">
          <a href="http://phantomjs.org" target="_blank">PhantomJS</a>, <a href="http://casperjs.org" target="_blank">CasperJS</a> or <a href="http://slimerjs.org" target="_blank">SlimerJS</a>, <a href="http://www.imagemagick.org/" target="_blank">Imagemagick</a>  and <a href="https://www.ruby-lang.org" target="_blank">Ruby</a>.  PhantomJS and SlimerJS are the browsers that capture the screenshots, CasperJS is a layer on top of these to aid in target selectors for capturing a particular component.
          <br>
          <br>Installation instructions for different Operating systems for these browsers and software can be found <a href="os-install.html">here</a>
          </p>
          <br>
          <h2>Installation</h2>
          <!-- <br> -->
          <pre>
          <code data-language="ruby">
gem install wraith
          </code>
          </pre>
          <br>
          <h2>Getting Started</h2>
          <p class="well note">
          To create template javascript and config files for use, use the setup command in terminal.  This will create folders in the directory you are in.  You can alternatively setup Wraith for CasperJS using the second command
          </p>
          <pre>
          <code data-language="ruby">
wraith setup
wraith setup_casper
          </code>
          </pre>
          <p class="well note">
          To start Wraith, use the capture command, passing the name of your config as an option.
          </p>
          <pre>
          <code data-language="ruby">
wraith capture configs/config.yaml
          </code>
          </pre>
          <br>
          <h3>Config options</h3>
          There are few different ways to use Wraith, comparison of 2 domains, capturing a specific component on a page, comparing the same domain over and over and spidering 2 domains for changes.  These all have slightly different configs, which you can see below, but there are some constants across the different usages.
          All config options will be placed in a config.yaml. You specify the snap file name, this could be used in a situation where you have a large amount of JS files. You set the headless browser, diff mode, threshold, fuzz amount and screen widths.
          <br>
          <br>
          <b>Headless browser</b> : This is typically PhantomJS or CasperJS, this is a browser that doesn't have a user interface, it runs in the backround.
          <br>
          <b>Diff Mode</b> : How you would like the gallery to be presented, you can set ordering and for the unchanged images to be removed.
          <br>
          <b>Threshold</b> : This is the minimal level of change you that want to present a failure.  The metric is percentage change of the page and set globally for a Wraith run.
          <br>
          <b>Fuzz</b> : Use this option to match colors that are close to the target color in RGB space, this number helps with anti-aliasing.
          <h3>Standard Mode</h3>
            Standard mode is the simplest to get going with.  Specify 2 domains as shown in this <a href="standard.html" target="_blank">this example config</a>, some paths on that domain and then run the config. Once set, run the config using the capture command.
          <h3>Casper Mode</h3>
            CasperJS allows for the targeting of a specific selector on a web page.  This could be used to check style guides, actual components or to ensure your tests don't get affected by other dynamic components.  The config is mostly the same as the standard mode except when setting the paths, this structure is different to allow passing of a selector.  <a href="component.html" target="_blank">In the example config</a>, you can see how we specify a component name, domain path and selector we want to capture.  Run using the wraith capture command.
          <h3>History Mode</h3>
            In Wraith 2.0 we introduced a new way for using Wraith in development and testing, historical shots. Rather than capture 2 domains, you capture 1 domain, probably your local copy of the latest code, then later on after development is in progress, run Wraith again to compare. This makes working against an isolated dev environment much easier.

The usage is different in that you need 1 domain in your config and you will need to set a historical shots folder. Specify a history_dir in addition to the directory key in your config.yml file. An example of this can be <a href="history.html" target="_blank">found here</a>.
<br>
Shots are captured as normal with the history command.
<br>
<br>
<pre>
  <code data-language="yaml">
  wraith history
  </code>
</pre>
This will create 2 folders with the labels you have specified in the config file, for example, shots and shots_history. The original shots will be copied into your 'history' folder, then copied back into the shots folder once you have run your latest job. This workflow will essentially mean your history folder is your baseline, being copied back into the shots folder every time you run the following
<br>
<br>
<pre>
  <code data-language="yaml">
  wraith latest
  </code>
</pre>
          <h3>Spidering Mode</h3>
          If you don't want to set paths, you can use the spidering option to check your entire website, remove/comment out the path: entries in config.yaml.  There are other spidering options too, including a spider file and regexs.  An example config can be seen <a href="spider.html" target="_blank">here</a>
          <p>
          <br>


          <h3>beforeCapture hooks</h3>

          <p>Using Casper Mode allows you to hook into a 'beforeCapture' event so that you can run arbitrary JavaScript before taking the screenshot. This allows you to regression test interactive content. (Note: the beforeCapture hook is currently only supported in Casper Mode).</p>

          <p>There are two options for hooking your JavaScript into the Wraith process, which are denoted by where you specify your 'before_capture' property. This is best illustrated using an example config:</p>



          <p>The before_capture at the top of the example is called before every path (i.e. before both 'clickable_guide' and 'clickable_gude__after_click'). The before_capture at the bottom of the example is called only before the path which it is associated with (i.e. only before 'clickable_guide__after_click'). The former can be considered 'global', and the latter 'local'.</p>

          <p>The global JS is always executed before the local JS. In the example above, that means 'clickable_guide' has global.js executed before a screenshot is taken, and 'clickable_gude__after_click' has global.js then local.js executed before a screenshot is taken.</p>

          <p>All of the before_capture hooks are optional.</p>

          <h3>Command line options</h3>
          <p></p>
          <p class="well note">
Wraith allows for most of the commands to be used individually, allowing you perform tasks as you see fit.  This assumes that your snap.js and config.yaml are in the folders that were created on setup.  There are other commands also available, these all expect a config_name to be passed as an option.
          </p>
          <pre>
		  <code data-language="shell">
  wraith capture [config_name]              # A full Wraith job
  wraith compare_images [config_name]       # compares images to generate diffs
  wraith crop_images [config_name]          # crops images to the same height
  wraith generate_gallery [config_name]     # create page for viewing images
  wraith generate_thumbnails [config_name]  # create thumbnails for gallery
  wraith history [config_name]              # Setup a baseline set of shots
  wraith latest [config_name]               # Capture new shots to compare with baseline
  wraith multi_capture [filelist]           # A Batch of Wraith Jobs
  wraith reset_shots [config_name]          # removes all the files in the shots folder
  wraith save_images [config_name]          # captures screenshots
  wraith setup                              # creates config & Javascript
  wraith setup_casper                       # creates config & Javascript for CasperJS
  wraith setup_folders [config_name]        # create folders for images
		  </code>
          </pre>
          <h2>Gallery & Output</h2>
          <p class="well">
          After each screenshot is captured, the compare task will run, this will output a diff.png and a data.txt.  The data.txt for each file will show the number of pixels that have changed.
          <br>
          <br>
          A gallery is available to view each of the images and the respective diff images located in the shots folder once all the images have been compared.
          </p>
          <br>
          <p class="well">
          If you are new to ruby, rake and PhantomJS, <a href="http://www.youtube.com/watch?v=gE_19L0l2q0" target="_blank">here is a great screencast</a> about how to use Wraith by <a href="https://twitter.com/klamping" target="_blank">Kevin Lamping</a>
          </p>
          <h2>Contributing</h2>
          <p class="well">
          If you want to add functionality to this project, pull requests are welcome.
          <br>
          <br>
          - Create a branch based off master and do all of your changes with in it
          <br>
          - If you have to pause to add a 'and' anywhere in the title, it should be two pull requests.
          <br>
          - Make commits of logical units and describe them properly
          <br>
          - Check for unnecessary whitespace with git diff --check before committing.
          <br>
          - If possible, submit tests to your patch / new feature so it can be tested easily.
          <br>
          - Assure nothing is broken by running all the test
          <br>
          - Please make sure that it complies with coding standards.
          </p>
		<h2>Copyright</h2>
        <p class="well">
            Copyright © BBC
        </p>
      </div>
      </div><!--/row-->

    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/rainbow/rainbow.min.js"></script>
    <script src="js/rainbow/language/generic.js"></script>
    <script src="js/rainbow/language/html.js"></script>
    <script src="js/rainbow/language/css.js"></script>
    <script src="js/rainbow/language/javascript.js"></script>
    <script src="js/rainbowlines/rainbow.linenumbers.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.tocify.min.js"></script>
    <script src="js/prettify.js"></script>

    <script>
        $(function() {

          $("#toc").tocify({ selectors: "h2, h3, h4", scrollTo: 60, highlightOffset: 60, extendPage: true });

          prettyPrint();

          $(".optionName").popover({ trigger: "hover", container: "body" });

          $("a[href='#']").click(function(event) {

              event.preventDefault();

          });

          Rainbow.color();
        });
    </script>

</div></body></html>
